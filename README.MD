
# ğŸ§© FastAPI Microservice â€“ User & Widget API ![Python](https://img.shields.io/badge/Python-3.13-blue) ![FastAPI](https://img.shields.io/badge/FastAPI-0.115.12-green) ![MongoDB](https://img.shields.io/badge/MongoDB-8.0.9-success) ![Docker](https://img.shields.io/badge/Docker-4.41-blue)

### ğŸ”§ Project Overview

A **complete microservice API** built with **FastAPI**, providing full REST support for **user** and **widget** resources. It features **JWT authentication**, **role-based access control**, **Redis caching**, and **MongoDB** as the data store. Monitoring is handled via **Prometheus** and **Grafana**. The system is containerized with **Docker** and deployed using **Kubernetes**.

---

### ğŸ§± Tech Stack

- **Python 3.13+**
- **FastAPI** â€“ high-performance async web framework
- **MongoDB** â€“ data persistence
- **Redis** â€“ in-memory cache store
- **Prometheus + Grafana** â€“ monitoring and visualization
- **Docker Desktop** â€“ image containerization
- **Kubernetes** â€“ container orchestration
- **uv** â€“ Python dependency manager

---

### ğŸ—‚ Project Structure

```bash
project/
â”œâ”€â”€ microservice/
â”‚   â”œâ”€â”€ api/                    # FastAPI logic
â”‚   â”‚   â”œâ”€â”€ .cert/              # Certificate files (SSL)
â”‚   â”‚   â”œâ”€â”€ core/               # Configuration, DB, RBAC
â”‚   â”‚   â”œâ”€â”€ models/             # MongoDB models
â”‚   â”‚   â”œâ”€â”€ schemas/            # Pydantic schemas
â”‚   â”‚   â”œâ”€â”€ scripts/            # Grafana dashboard
â”‚   â”‚   â”œâ”€â”€ utils/              # Utilities (e.g., sanitizer)
â”‚   â”‚   â”œâ”€â”€ Dockerfile          # API image definition
â”‚   â”‚   â””â”€â”€ main.py             # App entry point
â”‚   â”œâ”€â”€ .k8s/                   # Kubernetes manifests
â”‚   â”‚   â”œâ”€â”€ mongodb.yml
â”‚   â”‚   â”œâ”€â”€ redis.yml
â”‚   â”‚   â”œâ”€â”€ secret.yml
â”‚   â”‚   â”œâ”€â”€ service.yml
â”‚   â”‚   â”œâ”€â”€ deployment.yml
â”‚   â”‚   â””â”€â”€ prometheus/
â””â”€â”€ README.md
````

---

### âœ… Features

* User registration and login (with password hashing)
* JWT-based authentication
* Role-Based Access Control (RBAC)
* Widget CRUD functionality
* Redis-based caching
* MongoDB database backend
* Prometheus + Grafana monitoring
* Kubernetes-based deployment

---

### ğŸš€ Getting Started

#### 1. Clone the repository

```bash
git clone git@github.com:Kinetics20/project.git
cd project/microservice/api
```

#### 2. Install dependencies with `uv`

```bash
uv sync
```

#### 3. Generate SSL certificates

Navigate to the `.cert` directory and run:

```bash
cd microservice/api/.cert
openssl req -x509 --nodes -days 365 -newkey rsa:2048 -keyout key.pem -out cert.pem
```

These are used for secure authorization.

#### 4. Build Docker image

Go back to the `api` directory and build the Docker image:

```bash
cd ..
docker build -t fast:9 .
```

> If you change the image name (`fast:9`), update it in `.k8s/deployment.yml` under `containers.image`.

---

### â˜¸ï¸ Kubernetes Deployment

Ensure you have `kubectl` installed:

```bash
sudo snap install kubectl --classic
```

Apply manifests in the `.k8s` directory:

```bash
cd ../.k8s
kubectl apply -f mongodb.yml
kubectl apply -f redis.yml
kubectl apply -f secret.yml
kubectl apply -f service.yml
kubectl apply -f deployment.yml
```

---

### ğŸ” Check Deployment Status

```bash
kubectl get pods
```

Example output:

```
NAME                          READY   STATUS    RESTARTS   AGE
mongodb-0                     1/1     Running   ...         ...
redis-xxxxxxx                 1/1     Running   ...         ...
widget-api-xxxxxxx            1/1     Running   ...         ...
```

For monitoring (namespace `monitoring`):

```bash
kubectl get pods -n monitoring
```

---

### ğŸ“‘ API Documentation

Once running locally, open:

```
http://localhost/docs
```

![Swagger UI](https://github.com/Kinetics20/project/blob/main/microservice/docs/widget_Api.jpg)

---

### ğŸ“¦ Author

ğŸ‘¤ **Piotr LipiÅ„ski**
ğŸ—“ **Finished**: July 2025
ğŸ“« Contributions welcome!
